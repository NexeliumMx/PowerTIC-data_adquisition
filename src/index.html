<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Database Overview Test</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Database Overview Test</h1>
    <div id="content"></div>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            fetch('project-mtpower-default-rtdb-export.json')
                .then(response => response.json())
                .then(jsonData => {
                    const contentDiv = document.getElementById('content');

                    // Extrae las llaves del objeto lecturas
                    const keys = Object.keys(jsonData.lecturas);

                    keys.forEach((key, index) => {
                        // Crear un título h2 dinámico para cada ítem
                        const h2 = document.createElement('h2');
                        h2.textContent = `Medidor #${index + 1}: ${key}`;
                        contentDiv.appendChild(h2);

                        // Extraer la medición más reciente
                        const readings = jsonData.lecturas[key];
                        const latestReadingKey = Object.keys(readings).pop();
                        const latestReading = readings[latestReadingKey];

                        // Crear una tabla para mostrar los datos
                        const table = document.createElement('table');
                        const headers = ["Current A", "Current B", "Current C", "Date", "PF", "Power", "Time", "VAR", "Voltage AN", "Voltage BN", "Voltage CN"];
                        const headerRow = document.createElement('tr');

                        headers.forEach(header => {
                            const th = document.createElement('th');
                            th.textContent = header;
                            headerRow.appendChild(th);
                        });

                        table.appendChild(headerRow);

                        // Crear la fila de valores
                        const valueRow = document.createElement('tr');
                        headers.forEach(header => {
                            const td = document.createElement('td');
                            td.textContent = latestReading[header];
                            valueRow.appendChild(td);
                        });

                        table.appendChild(valueRow);
                        contentDiv.appendChild(table);
                    });
                })
                .catch(error => console.error('Error al cargar el archivo JSON:', error));
        });
    </script>
</body>
</html>